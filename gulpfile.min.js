var gulp=require("gulp"),concat=require("gulp-concat"),cssmin=require("gulp-cssmin"),htmlmin=require("gulp-htmlmin"),uglify=require("gulp-uglify"),merge=require("merge-stream"),del=require("del"),bundleconfig=require("./bundleconfig.json"),regex={css:/\.css$/,html:/\.(html|htm)$/,js:/\.js$/};gulp.task("min",["min:js","min:css","min:html"]),gulp.task("min:js",function(){var e=getBundles(regex.js).map(function(e){return gulp.src(e.inputFiles,{base:"./app/scripts"}).pipe(concat(e.outputFileName)).pipe(uglify()).pipe(gulp.dest("."))});return merge(e)}),gulp.task("min:css",function(){var e=getBundles(regex.css).map(function(e){return gulp.src(e.inputFiles,{base:"./app/styles"}).pipe(concat(e.outputFileName)).pipe(cssmin()).pipe(gulp.dest("."))});return merge(e)}),gulp.task("min:html",function(){var e=getBundles(regex.html).map(function(e){return gulp.src(e.inputFiles,{base:"."}).pipe(concat(e.outputFileName)).pipe(htmlmin({collapseWhitespace:!0,minifyCSS:!0,minifyJS:!0})).pipe(gulp.dest("."))});return merge(e)}),gulp.task("clean",function(){var e=bundleconfig.map(function(e){return e.outputFileName});return del(e)}),gulp.task("clean_public",function(){return del("./public/*")}),gulp.task("watch",function(){getBundles(regex.js).forEach(function(e){gulp.watch(e.inputFiles,["min:js"])}),getBundles(regex.css).forEach(function(e){gulp.watch(e.inputFiles,["min:css"])}),getBundles(regex.html).forEach(function(e){gulp.watch(e.inputFiles,["min:html"])})});function getBundles(e){return bundleconfig.filter(function(n){return e.test(n.outputFileName)})}